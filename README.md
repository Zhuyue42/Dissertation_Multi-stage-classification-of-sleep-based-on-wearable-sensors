# Dissertation_Multi-stage-classification-of-sleep-based-on-wearable-sensors
## 项目描述
本项目基于MESA数据集提供的生理信号与多睡眠导图的睡眠阶段标注，使用从原始生理信号中提取的心率变异性（HRV）特征集，探究使用便携式可穿戴设备提供的数据用于自动睡眠分类的可能性。  
本项目使用HRV特征集而非原始生理数据，其目的是确保便携式可穿戴设备提供的数据如光电容积变化扫描图也可用于提取该特征，并用于睡眠阶段分类。本项目已对该目标进行验证。
## 代码说明
**MESA_Feture:** 用于从MESA提供的心电图以及运动学数据中提取特征，机器学习实验使用30个HRV特征以及370个运动数据的统计特征，深度学习实验使用8个HRV特征。  
**ECG_Proess：** 用于从普适的原始心电图数据中检测RR心跳间隔以及提取HRV特征。  
**DL_Expriment:** 深度学习实验，本项目使用模型为CNN,LSTM以及LSTM-Attention  
**ML_Expriment:** 机器学习实验，并非项目重点，因此只进行了随机森林实验。  
**PPG:** 使用MESA提供的光电容积变化扫描图（PPG）数据提取HRV特征集并进行机器学习实验与深度学习实验，模型参数与ECG的模型参数保持一致，用于探究特征集与模型是否有可移植性与拓展性。 
## 数据集
本项目使用数据库为MESA数据集，以下介绍直接摘自官网： 

多种族动脉粥样硬化研究（MESA）是一项由国家卫生研究院生物研究所（NHLBI）赞助的六中心合作纵向调查，调查对象为 2000-2002 年基线年龄最初为 45-84 岁的 6814 名黑人、白人、西班牙裔和华裔男性和女性，调查内容是亚临床心血管疾病的发生和亚临床心血管疾病进展的相关因素。迄今为止，已在 2003-2004、2004-2005、2005-2007 和 2010-2011 年进行了四次随访检查。2010 年至 2012 年期间，2237 名参与者还参加了睡眠检查（MESA 睡眠），其中包括整夜无人值守多导睡眠图、7 天腕戴式动图和睡眠问卷。睡眠研究的目的是了解不同性别和种族群体在睡眠和睡眠障碍方面的差异，以及这些差异与亚临床动脉粥样硬化测量的关系。
MESA 睡眠数据是与 MESA 协调中心合作提供的。我们提供了多导睡眠图和动静描记术的原始数据，以及主要的 MESA 睡眠协变量集，供您下载。如果您希望访问其他 MESA 检查的数据，请访问 BioLINCC MESA 套件或联系 MESA 协调中心。
该数据集需申请使用权限，需注册账号，提交研究目的等信息作为申请，官方网址： [NSRR](https://sleepdata.org/datasets/mesa)

## 数据预处理
如果获取MESA数据集使用权限，可使用其提供的R-point数据集，其位置为mesa/polysomnography/annotations-rpoints/，该数据集储存受试者心电图中每个R波波峰，并标注每个R波波峰时间点，所属睡眠纪元与PSG睡眠阶段（0：清醒，1：非快速眼动期1期，2：非快速眼动期2期，3：非快速眼动期3期，4/5：快速眼动期）。研究者可直接使用该数据集提取RR间隔并提取心率变异性（HRV）特征集。该部分代码详见**MESA_Feature** 。
